generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// =====================
// THEME
// =====================
model Theme {
  id            String   @id @default(cuid())
  primary       String
  secondary     String
  action        String
  primaryText   String
  secondaryText String
  actionText    String

  company       Company?
  posts         Post[]
}

// =====================
// USER
// =====================
model User {
  id           String        @id @default(cuid())
  name         String
  username     String        @unique
  avatar       String
  bio          String
  location     String
  skills       String[]
  hobbies      String[]

  experiences  Experience[]
  employments  Employment[]
  foundations  CompanyFounder[]

  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

// =====================
// EXPERIENCE
// =====================
model Experience {
  id        String   @id @default(cuid())
  type      String
  role      String
  startDate String
  endDate   String?

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    String

  company   Company? @relation(fields: [companyId], references: [id])
  companyId String?
}

// =====================
// COMPANY
// =====================
model Company {
  id          String        @id @default(cuid())
  name        String
  slug        String        @unique
  logo        String
  cover       String
  description String
  location    String
  website     String

  theme       Theme         @relation(fields: [themeId], references: [id])
  themeId     String        @unique

  stats       CompanyStats?
  about       CompanyAbout?
  employments Employment[]
  founders    CompanyFounder[]
  jobs        Job[]
  widgets     Widgets?
  posts       Post[]
  experiences Experience[]

  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

// =====================
// USER ↔ COMPANY (EMPLOYEE)
// =====================
model Employment {
  id        String   @id @default(cuid())
  role      String
  startDate DateTime?
  endDate   DateTime?

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    String

  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId String

  @@unique([userId, companyId])
}

// =====================
// USER ↔ COMPANY (FOUNDER)
// =====================
model CompanyFounder {
  id        String   @id @default(cuid())
  role      String

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    String

  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId String

  @@unique([userId, companyId])
}

// =====================
// COMPANY STATS
// =====================
model CompanyStats {
  id          String  @id @default(cuid())
  employees   Int
  founded     Int
  genderRatio String
  lastFunding String
  totalRaised String

  company     Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId   String  @unique
}

// =====================
// COMPANY ABOUT
// =====================
model CompanyAbout {
  id             String         @id @default(cuid())
  history        String
  mission        String
  vision         String

  company        Company        @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId      String         @unique

  officeLocation OfficeLocation?
}

// =====================
// OFFICE LOCATION
// =====================
model OfficeLocation {
  id       String       @id @default(cuid())
  address  String
  mapImage String

  about    CompanyAbout @relation(fields: [aboutId], references: [id], onDelete: Cascade)
  aboutId  String       @unique
}

// =====================
// JOB
// =====================
model Job {
  id        String  @id @default(cuid())
  title     String
  type      String
  location  String
  remote    Boolean

  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId String
}

// =====================
// WIDGETS
// =====================
model Widgets {
  id           String        @id @default(cuid())

  company      Company       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId    String        @unique

  stats        Stat[]
  benefits     Benefit[]
  processSteps Step[]
  features     Feature[]
  pricingPlans PricingPlan[]
  faqItems     FAQItem[]
}

model Stat {
  id        String  @id @default(cuid())
  label     String
  value     String

  widgets   Widgets @relation(fields: [widgetsId], references: [id], onDelete: Cascade)
  widgetsId String
}

model Benefit {
  id          String  @id @default(cuid())
  title       String
  description String

  widgets     Widgets @relation(fields: [widgetsId], references: [id], onDelete: Cascade)
  widgetsId   String
}

model Step {
  id          String  @id @default(cuid())
  title       String
  description String

  widgets     Widgets @relation(fields: [widgetsId], references: [id], onDelete: Cascade)
  widgetsId   String
}

model Feature {
  id          String  @id @default(cuid())
  title       String
  description String
  image       String?

  widgets     Widgets @relation(fields: [widgetsId], references: [id], onDelete: Cascade)
  widgetsId   String
}

model PricingPlan {
  id          String   @id @default(cuid())
  name        String
  price       String
  description String
  features    String[]
  isPopular   Boolean  @default(false)
  ctaText     String

  widgets     Widgets  @relation(fields: [widgetsId], references: [id], onDelete: Cascade)
  widgetsId   String
}

model FAQItem {
  id        String  @id @default(cuid())
  question  String
  answer    String

  widgets   Widgets @relation(fields: [widgetsId], references: [id], onDelete: Cascade)
  widgetsId String
}

// =====================
// POST (POLYMORPHIC)
// =====================
model Post {
  id         String   @id @default(cuid())
  content    String
  image      String?
  createdAt  DateTime @default(now())
  likes      Int      @default(0)
  comments   Int      @default(0)

  authorType PostAuthorType
  authorId   String

  theme      Theme?   @relation(fields: [themeId], references: [id])
  themeId    String?
  
  company    Company? @relation(fields: [companyId], references: [id])
  companyId  String?
}

enum PostAuthorType {
  USER
  COMPANY
}
